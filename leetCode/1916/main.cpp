#include <iostream>
#include <bits/stdc++.h>

using namespace std;

long long MOD = 1e9 + 7;

inline long long modMult(long long a, long long b)
{
    return ((a % MOD) * (b % MOD)) % MOD;
}

inline long long modSum(long long a, long long b)
{
    return ((a % MOD) + (b % MOD) + MOD) % MOD;
}

inline long long modPow(long long a, long long b)
{
    long long res = 1;
    while(b)
    {
        if (b % 2)
        {
            res = modMult(res, a);
        }

        b /= 2;
        a = modMult(a, a);
    }

    return res;
}

inline long long modInverse(long long a)
{
    return modPow(a, MOD - 2);
}

inline long long modDivide(long long a, long long b)
{
    return modMult(a, modInverse(b));
}

const int factorialStorageSize = 100001;
int factorial[factorialStorageSize] = {1};
int invFactorial[factorialStorageSize] = {1};

class Solution {
    void countFactorials() {
        if (factorial[1]) {
            return;
        }

        for (int i = 1; i < factorialStorageSize; i++) {
            factorial[i] = modMult(i, factorial[i - 1]);
            invFactorial[i] = modInverse(factorial[i]);
        }
    }

    int permutationsCount(std::vector<int> sizes)
    {
        countFactorials();

        int res = 1;
        int sum = 0;

        for (size_t i = 0; i < sizes.size(); i++)
        {
            res = modMult(res, invFactorial[sizes[i]]);
            sum += sizes[i];
        }
        

        res = modMult(res, factorial[sum]);
        

        return res;
    }

    std::vector<std::list<int>> tree;

    struct Res {
        int variants = 0;
        int nodesInTree = 0;
    };

    Res variantsCount(int node)
    {
        Res res;
        res.variants = 1;
        res.nodesInTree = 1;

        if (tree[node].empty()) {
            return res;
        }

        std::vector<int> sizes;
        sizes.reserve(tree[node].size());

        for (int child : tree[node])
        {
            auto subRes = variantsCount(child);
            sizes.push_back(subRes.nodesInTree);
            
            res.nodesInTree += subRes.nodesInTree;

            res.variants = modMult(res.variants, subRes.variants);
        }
        
        int permutations = permutationsCount(sizes);

        res.variants = modMult(res.variants, permutations);

        return res;
    }

public:
    int waysToBuildRooms(vector<int>& prevRoom) {
        if (!tree.empty())
        {
            tree.clear();
        }

        tree.resize(prevRoom.size());
        for (int i = 1; i < prevRoom.size(); i++)
        {
            tree[prevRoom[i]].push_back(i);
        }
        
        auto res = variantsCount(0);

        return res.variants;
    }
};

bool equal(int i1, int i2)
{
    return i1 == i2;
}

bool equal(const vector<int>& v1, const vector<int>& v2)
{
    if (v1.size() != v2.size())
    {
        return false;
    }

    for (size_t i = 0; i < v1.size(); i++)
    {
        if (v1[i] != v2[i])
        {
            return false;
        }
    }
    
    return true;
}


void solve(std::istream& in, std::ostream& out)
{
    Solution s;
    vector<int> v;

    // v = {-1,0,1};
    // out << (s.waysToBuildRooms(v) == 1) << std::endl;
    // v = {-1,0,0,1,2};
    // out << (s.waysToBuildRooms(v) == 6) << std::endl;
    v = {-1,0,1,1,0,1,4,1,7,7,5,2,8,6,12,10,10,10,6,12,17,0,1,20,0,22,17,9,4,15,11,6,15,12,22,16,6,9,35,12,13,35,15,5,2,9,34,46,26,22,44,40,31,10,2,6,35,33,8,26,31,37,34,22,27,41,15,24,4,48,0,26,47,3,70,32,51,3,50,75,77,34,71,13,59,62,12,16,9,54,73,11,21,75,4,83,69,14,59,86,81,81,91,16,67,35,35,4,26,97,97,9,29,94,65,36,48,113,12,26,108,23,63,17,113,54,17,93,37,91,99,54,117,60,61,96,109,74,90,44,33,133,8,91,89,144,49,69,50,6,147,113,26,83,108,145,39,118,29,100,119,130,64,155,131,79,126,100,126,2,97,100,48,111,23,47,52,21,16,0,132,50,161,47,144,96,135,162,160,72,92,127,93,152,181,192,120,116,107,73,3,73,199,27,10,178,79,75,78,59,128,103,76,2,208,49,170,172,118,159,189,101,221,222,38,8,160,25,44,160,182,64,175,79,169,163,175,73,98,213,159,231,31,237,70,25,162,25,221,2,179,100,44,152,104,54,0,173,247,178,212,0,154,262,107,107,230,238,101,190,53,103,1,15,4,250,152,7,245,267,39,11,161,98,210,119,191,205,102,191,240,35,209,59,120,267,69,100,262,16,85,127,193,184,75,153,86,109,228,147,184,238,118,43,15,106,140,160,28,180,48,179,165,212,270,57,169,299,231,120,261,2,271,156,288,207,88,244,272,238,195,31,106,257,7,184,65,1,183,259,310,261,156,338,6,15,222,135,86,84,208,91,1,319,241,145,352,32,260,151,187,202,96,369,338,63,181,339,190,104,204,266,194,16,152,181,335,244,290,53,238,375,82,234,163,9,294,258,77,247,120,314,110,122,106,157,316,255,120,397,385,363,304,22,11,389,123,34,193,329,210,368,392,421,9,99,352,214,137,195,4,349,165,256,58,381,187,359,18,172,204,353,4,401,211,140,213,39,209,312,425,329,232,419,95,253,450,149,422,424,398,2,188,36,339,379,165,450,165,129,43,182,73,314,457,22,363,9,430,81,262,211,463,211,15,28,138,381,172,289,430,260,145,479,486,382,379,490,166,202,438,374,119,246,48,83,299,170,146,151,198,389,387,320,135,338,351,312,5,174,311,63,264,450,224,66,344,18,139,361,423,101,164,476,268,0,283,212,299,420,153,189,500,301,108,186,448,102,167,532,464,547,199,544,110,170,533,488,260,429,106,75,540,61,425,401,347,462,408,268,52,257,365,487,373,542,140,168,69,327,343,312,404,294,108,218,555,342,12,470,518,62,318,354,151,128,283,215,357,388,43,38,357,489,163,185,351,317,502,401,162,351,548,1,114,544,601,43,299,369,323,250,599,414,57,393,263,71,422,253,367,325,126,450,401,242,30,114,330,122,276,199,194,336,529,415,93,438,138,624,449,622,69,547,303,575,614,297,188,264,510,341,413,189,542,566,440,652,201,3,337,346,593,464,373,80,579,643,633,147,621,526,353,492,542,195,589,499,435,682,211,205,447,169,683,579,501,578,317,80,567,549,634,355,625,386,126,585,484,671,591,631,250,58,319,368,284,119,529,603,70,431,172,46,599,590,437,236,236,132,556,679,661,343,125,290,590,258,296,465,505,244,271,663,241,727,566,393,726,626,59,418,378,370,530,670,239,259,284,537,443,278,546,664,591,34,523,544,465,187,400,265,80,317,587,167,43,328,773,274,118,731,164,282,84,481,383,381,462,307,350,452,301,643,165,459,693,579,665,408,798,700,493,71,764,584,338,388,468,636,535,64,528,380,68,804,402,440,480,532,228,605,709,434,691,360,321,38,271,148,259,457,184,789,344,736,809,228,85,416,672,101,792,456,509,343,24,106,256,96,450,771,813,187,210,411,588,573,9,102,844,397,159,244,510,755,290,0,108,805,364,167,407,732,466,366,16,356,641,510,666,622,167,234,790,740,95,292,371,710,583,475,798,38,6,462,557,205,837,641,3,763,89,550,835,553,661,879,663,365,849,454,58,317,162,544,105,470,844,465,22,172,585,116,634,623,181,14,429,158,461,625,196,355,625,47,444,7,75,748,342,136,447,886,519,577,621,736,611,366,622,847,862,824,432,600,779,268,802,915,437,932,22,134,870,660,769,296,869,332,856,91,831,901,308,354,41,602,420,865,526,946,226,402,887,180,357,676,234,123,255,680,220,909,401,559,360,55,372,965,685,404,798,137,126,30,465,108,435,963,202,348,92,215,239,480,634,60,984,546,768,667,990,738,552,965,1004,875,209,362,566,926,1021,920,617,706,179,256,672,265,943,111,463,746,539,708,992,483,337,182,10,481,149,650,831,254,987,804,639,1042,47,1045,142,712,916,336,599,1,76,908,846,958,773,370,321,418,107,922,45,173,406,903,87,674,885,317,935,667,824,232,9,362,17,283,418,454,910,747,103,184,33,70,867,227,862,454,536,377,117,730,202,701,622,974,549,930,486,455,845,67,65,425,788,814,495,425,899,86,62,356,1,720,672,245,263,623,404,585,154,650,78,443,706,1027,898,828,984,448,160,1067,934,884,578,366,48,262,23,1059,574,762,176,489,502,541,1030,495,522,894,695,233,810,992,187,745,252,770,564,531,933,983,319,617,461,419,27,199,302,66,212,335,620,733,611,340,379,441,731,407,1096,1183,158,1145,432,591,912,162,220,57,718,872,852,1030,93,643,1065,720,980,778,654,672,753,345,563,1009,168,93,205,722,60,431,18,1092,414,839,898,139,358,854,1089,1129,178,257,465,698,882,619,15,582,958,1196,954,767,1036,810,827,759,34,758,594,34,1004,618,914,310,635,508,201,167,538,77,1185,37,210,82,653,573,616,193,720,510,1271,487,1053,1064,1146,513,243,746,1140,1066,58,1067,627,1139,43,473,1264,936,256,1092,565,645,922,937,779,643,651,1264,984,1134,793,952,31,789,964,631,728,73,23,677,514,1278,854,124,744,768,548,835,568,481,1107,72,386,512,338,759,464,127,1062,698,932,886,1009,427,417,936,37,1230,917,114,179,1218,1163,889,1109,151,256,41,1074,665,400,1287,1034,652,246,1272,573,1232,279,1320,335,1221,954,403,131,121,951,920,301,887,783,1183,25,1111,333,248,277,198,537,545,277,370,419,1040,568,1054,138,535,1230,1312,684,142,316,503,1076,973,1172,215,417,203,1220,980,764,410,535,1081,267,1365,1175,1223,379,567,658,1151,481,23,520,1119,1048,303,1345,777,224,13,793,624,1176,1335,586,1103,688,764,1254,1441,419,289,915,963,1167,48,391,607,1135,577,176,1142,64,181,712,376,1381,782,849,481,1406,843,1451,988,718,62,1108,30,1344,1341,912,356,960,269,1457,720,193,671,804,321,183,491,1385,257,258,1203,819,562,648,8,220,713,90,35,342,8,1311,700,608,277,267,1115,487,1413,779,1279,1142,58,13,1307,991,921,454,890,1282,586,1155,673,227,658,1198,300,902,96,966,655,613,1402,328,1476,535,53,1172,864,362,93,444,364,309,1078,311,1338,861,1326,188,87,33,1174,1204,707,1115,311,562,810,1378,671,225,1098,1282,1061,1491,352,100,1436,967,423,337,327,765,1270,1134,120,1520,766,332,104,1279,1302,938,990,519,163,453,60,151,324,371,1148,40,1290,145,8,1140,954,163,1405,307,505,566,1297,871,329,601,1599,468,1379,206,561,1147,816,899,845,8,759,272,1608,75,1193,1156,52,50,1476,1024,1073,663,921,348,518,1443,394,1130,827,1145,350,251,905,158,1539,1119,1270,1496,1436,61,364,193,1533,1472,954,842,557,1079,1027,440,398,147,1229,1186,814,250,414,1125,403,1287,632,1214,481,199,1621,712,1194,549,723,1122,102,956,756,389,1409,213,872,158,1605,14,1553,57,1512,1512,777,907,848,491,639,1381,1200,1100,194,600,971,1248,347,1575,769,584,206,464,932,1378,1287,857,1627,404,928,85,1655,400,656,1216,149,1064,1683,1113,601,1650,419,33,1014,1195,1147,1065,873,547,1685,1490,1151,1284,409,149,1258,45,1223,1735,360,601,1339,891,720,89,250,965,397,789,152,1192,440,1295,1317,40,1568,639,190,53,717,818,1451,309,881,1341,1007,576,397,425,422,1373,1253,604,1468,318,600,506,523,853,1440,1433,240,643,256,906,1600,1328,1288,1340,1619,1054,1374,1552,296,1363,1180,219,1592,1079,484,1461,1203,1530,1797,941,485,717,232,901,1199,1232,1541,1236,493,1579,1383,1484,755,1352,1626,1167,887,1043,462,1366,184,1416,10,150,1754,1380,1081,55,806,1654,1349,395,749,1167,429,280,600,1512,1787,1358,1168,1580,907,739,1222,1734,1853,1584,1685,433,676,1845,1401,1298,1394,1340,69,268,468,1058,1464,549,466,536,1487,1381,1815,585,1847,568,1378,1140,959,985,1795,863,960,1511,1825,1837,988,1097,918,22,286,699,765,338,1264,1363,1105,1226,314,1328,1758,344,41,336,205,1497,1054,1711,1525,1689,1288,1276,776,1504,1679,1291,126,658,1768,279,408,256,391,677,346,1071,158,1112,1341,830,1220,1184,20,1834,352,792,76,1818,403,854,231,558,112,1767,1412,1218,916,249,1365,973,197,1442,1112,407,1405,841,1892,1315,503,829,17,1203,566,1549,1578,765,0,1690,607,1139,132,770,866,172,1057,1936,41,1434,1837,1117,1578,1801,1340,112,1744,706,1556,554,714,1710,996,160,1768,1308,1963,652,910,1419,1100,899,199,594,1078,1037,750,1713,1539,1988,294,511,630,1771,1654,1524,1596,1379,1742,1106,846,1661,1240,73,1649,13,1885,685,1136,1273,1673,832,1270,569,487,1092,547,325,1854,89,921,1024,1286,320,1462,733,1094,665,306,1108,1268,1831,944,61,1148,285,899,466,1025,1860,834,887,1776,1094,1734,1283,1732,1951,1271,451,1660,785,1836,77,2061,1748,1402,396,383,1228,1494,1995,348,996,1610,1586,675,1243,1758,1099,1555,2086,230,1714,55,1917,1860,100,1129,1486,2092,1640,1873,26,1100,1470,1399,364,456,581,1113,1717,730,1199,84,1727,1908,1306,1238,390,2056,179,1271,216,505,970,2027,981,735,653,592,1326,734,60,669,1928,2041,112,1638,1087,966,370,294,1005,1236,1269,2051,1136,2031,1538,1778,1571,2102,1575,59,1834,857,634,563,1616,1437,1622,1366,206,482,598,962,61,1891,1823,2169,2117,214,804,1499,234,1787,1120,494,1593,279,1489,153,389,823,94,1773,1741,1548,1118,1638,447,1271,793,1137,1251,1052,967,1832,647,1066,1654,1789,375,569,486,106,1958,567,1251,578,1813,1606,1610,2134,6,464,774,1301,1541,2030,208,431,1981,390,671,578,1357,1914,1435,1416,1573,454,318,2164,1899,1575,1316,2105,146,1422,1458,1892,1177,126,1130,2167,556,1076,1643,2049,2221,634,1721,262,1325,224,947,2177,335,2249,1262,1706,539,783,277,1460,2028,544,200,1052,990,2136,1963,510,679,2240,271,1931,402,1024,1336,529,1774,2157,1422,2138,142,943,1333,898,279,2124,645,1247,2274,1338,1572,13,372,231,811,2088,1631,1955,391,1904,1637,1712,665,74,2188,879,1305,757,2130,1459,1549,1105,1423,615,1752,2237,1549,2245,1837,407,1831,1302,2233,1229,386,733,1940,1411,574,1661,77,296,398,1828,573,108,1331,2319,72,260,1788,204,1916,1686,1591,520,785,1506,1975,1583,208,160,2340,137,1816,1045,308,535,784,453,1159,1262,1388,51,1349,1798,1167,2125,955,1211,661,884,1264,1666,9,982,2100,2063,2067,591,5,2078,1174,2190,762,397,436,91,927,106,763,123,1683,2087,2249,2396,1246,1160,1103,1695,1738,2405,1446,77,253,1068,1083,2400,1553,134,2272,1266,192,1823,1607,871,1794,585,2155,201,218,960,586,3,170,1283,1207,2385,1292,1161,335,1756,867,1971,159,1315,2291,1954,435,1947,1308,1628,1516,646,305,2150,2276,555,134,2439,2247,1089,1118,1057,1704,1558,855,1088,1300,2262,1478,2180,1857,1634,471,470,
    14,1201,596,2206,361,2107,1852,2315,201,978,1815,1765,2200,2089,2128,1914,2122,1593,2258,864,2118,1435,1572,545,1826,15,2390,2414,497,116,2026,1191,2401,2206,2439,188,80,1733,1151,613,1444,1396,1856,334,239,522,644,2443,795,157,1483,1928,687,2246,1676,2482,2112,1189,1137,1581,1987,276,2432,300,482,2338,763,668,198,1594,2060,332,2226,2034,1765,1224,748,194,1578,1981,2499,918,484,742,745,2198,1761,1542,704,372,17,1937,1943,668,258,1969,36,621,104,632,171,624,295,2528,2495,1056,817,2411,360,1884,1015,665,1155,1461,604,718,1509,1472,2192,2536,925,1112,1559,1820,2070,304,1046,290,910,176,2338,2443,730,655,2198,1868,2179,490,2055,687,886,876,354,1672,491,2391,2610,425,466,882,287,1284,1253,1558,358,1990,1243,745,1433,1340,652,59,1505,2328,1226,760,1649,559,672,2004,1210,1304,811,2025,1951,194,697,1888,716,1829,577,2420,1416,2157,537,197,1056,2625,2153,445,893,302,1184,1636,1453,911,1659,1954,721,2277,1055,2354,205,1597,275,2574,1500,592,1880,2343,1958,332,520,231,1919,424,1936,1460,328,2347,2401,2184,713,2350,1130,2528,2101,2296,700,1206,853,2234,1013,576,1580,49,1509,1519,1930,803,474,458,1755,1502,247,986,2138,423,811,212,1671,723,896,2182,87,1094,703,2003,27,2218,992,59,2232,1421,609,2593,2188,1607,1817,2066,1209,118,1199,2050,2109,1015,259,187,2319,736,161,1693,1093,2589,1533,1039,1133,318,1209,2394,1435,1908,2323,979,2060,789,933,2036,2269,1151,383,1701,2024,266,536,2751,1425,722,351,1619,1598,2262,1274,421,687,104,366,694,515,1705,531,1404,2112,1573,1224,1195,2627,2469,1764,2030,2120,1575,1281,1762,2182,1052,2422,2609,2198,636,800,2229,2699,2286,333,236,2281,1244,2098,1251,1340,1044,2499,2795,2378,522,1023,1863,1937,2596,2378,2361,2048,1894,11,780,1366,1795,637,2580,734,1267,1563,3,875,1466,1617,1047,2378,1533,2617,704,589,1660,1265,765,2164,2751,1980,2560,1477,1619,2564,2311,1613,668,375,1164,683,1820,1096,2390,140,1880,2231,1936,913,523,101,2718,1121,1398,423,1909,671,1528,2445,1691,1983,217,1661,491,807,2674,109,248,1604,1271,2145,1130,214,692,1130,2529,774,2463,1256,1856,798,554,109,1536,1419,1515,1350,1650,1469,1369,2066,525,2874,1368,127,1013,2794,645,318,468,2625,1851,1531,1255,829,2631,1962,1308,895,102,262,2869,2884,1125,849,1972,76,373,1003,336,948,619,1307,2785,1805,869,1222,1706,2579,2011,584,1684,490,236,864,1628,808,814,1862,1516,2778,986,2804,2249,1967,2741,1402,1693,1329,2822,2693,2691,2485,2601,1854,2308,1669,2559,2680,2924,458,2226,2126,564,59,1935,867,1189,284,266,2366,1428,1675,167,2390,597,2474,101,50,464,2841,1027,962,2830,2695,201,1109,2823,1165,1083,1577,1400,1792,1597,1170,1389,2570,1137,2118,914,250,1864,1250,1180,1463,862,905,2588,2717,688,581,642,2197,2074,742,2876,571,911,1531,2802,1282,2123,2800,2879,2852,2143,193,2711,1833,193,2016,1742,901,789,672,959,496,381,455,1928,2425,2960,1667,833,2949,755,1552,2826,2913,1518,2386,1217,927,2537,2022,1110,2047,1565,126,1516,855,1504,1375,2876,710,2490,969,903,193,2081,411,1512,2721,996,1918,2245,1506,880,2654,2980,1057,227,351,859,2960,1999,1602,662,654,1722,189,654,1291,2254,346,6,2441,15,2581,1138,1762,1007,2420,2802,958,356,2352,2590,1917,404,1931,497,826,676,1674,3066,2251,1211,637,2019,1086,1344,2495,935,767,165,615,608,2634,1435,709,1389,126,2493,2225,2604,1397,510,154,14,522,2939,1300,1636,720,2233,3162,2189,1046,1458,2003,19,1539,912,2506,2442,104,3089,3129,1190,668,1785,1320,889,2184,1228,1554,1413,2456,863,289,2733,1803,959,2993,189,2812,3089,1832,921,2516,3180,2215,1623,1184,1302,905,2224,3056,2168,55,1060,2356,3011,2125,2938,1766,3189,730,1538,3063,2834,555,1506,2638,2242,1315,440,1608,2010,3042,2705,3057,1968,1444,2752,1807,2667,397,2821,1997,972,2864,1271,546,1448,203,2062,591,323,1861,2563,2494,2804,2591,2788,3092,1118,2442,3192,1173,1672,583,983,2300,1082,2491,1289,574,3205,2392,1159,291,2571,429,2247,986,3068,2262,2313,782,742,3014,2951,50,2658,1139,1794,1666,1025,2661,2048,1444,1335,2546,3255,658,1787,1757,2732,2448,1056,3259,1650,922,1198,2375,1261,2871,1162,3113,950,1268,421,3114,537,2322,3039,2859,61,617,886,1305,2891,1471,1890,500,1634,2127,325,162,1882,3116,2126,2168,945,1091,1801,3187,1014,2548,892,299,2218,802,1677,2230,2424,2228,1288,2462,85,85,811,594,249,875,582,1622,2812,1762,2553,1425,3301,2708,1788,2805,172,1125,1614,3089,1963,980,61,2374,3372,1601,1919,218,2700,3262,1541,921,477,1307,48,150,1151,1768,1349,1836,3058,2362,2459,1516,2355,68,1173,2013,1005,3292,1754,1509,1251,440,1462,2939,2840,75,141,3106,904,3213,491,1964,2336,1155,649,66,2963,2001,2173,1025,1999,2148,2225,1002,3117,1138,415,3182,1302,348,41,1045,2762,2951,2761,1790,2757,2118,1150,1616,2460,3313,1041,2816,1239,238,471,1983,2824,732,3266,1241,1935,391,2586,460,2148,2270,1456,1049,1928,160,1367,314,740,2224,105,416,1139,1277,1872,318,3114,1836,1613,825,2417,168,816,389,1867,1890,3389,1673,3241,129,1010,2097,2491,1255,320,3332,2849,3200,2508,2360,870,1825,3059,2887,1259,3232,830,3120,346,2462,3351,2805,1121,461,526,1417,1654,255,3174,699,153,2088,2448,1795,707,1791,2688,2147,1233,2430,1811,1079,2838,2885,929,2618,2070,2069,815,1171,2183,1644,2901,3549,2552,799,2409,3005,2652,194,1468,1185,2816,2888,2871,1505,3558,711,1479,1168,3120,1565,948,1561,289,1007,1763,2631,1089,2167,322,498,3208,1626,489,2362,1732,3547,3488,2379,2052,54,2604,547,1609,768,1422,2471,2582,911,2589,692,619,2989,1250,3389,2756,1445,2921,1303,1363,2574,43,384,97,2175,3233,2256,546,2713,1126,1035,3411,2934,2070,2139,17,1832,920,1825,2907,307,1558,616,3177,2233,2527,1799,544,1162,261,1526,2710,795,702,812,1704,3192,1377,1939,3277,847,2253,3222,4,40,279,2420,1031,267,3486,1502,1253,16,193,1403,2720,3231,2037,2535,1973,1282,3526,3674,1048,1886,3389,3065,2606,669,2206,3470,1978,830,416,1085,2719,2388,2127,1861,376,2675,192,823,2084,1181,277,1274,3467,804,2120,2539,314,2272,3067,3199,1654,2753,1552,2889,2073,2244,1496,2326,2006,2467,1433,1577,1003,2608,3120,3686,1392,422,1722,2768,645,1219,1850,624,2934,1163,2778,2956,2144,1858,2490,1901,1079,1763,811,2169,2962,3692,176,365,3143,3122,3690,3015,796,1361,1502,3226,149,1907,2243,2656,180,1492,1310,3559,1551,2423,3748,2315,3305,216,2161,323,3608,1698,11,1514,1740,2757,1196,2629,3590,559,3250,3356,1004,1109,3704,2672,1406,350,1053,949,534,766,903,1665,2412,417,1896,1333,3658,1662,1191,56,490,2908,3459,2613,1010,1494,3477,981,3542,2845,2033,565,373,1814,3582,3205,2276,2355,483,2379,1968,2531,1751,1477,1928,3108,2295,1089,3435,3291,3584,1916,2389,759,992,1663,1923,509,2071,2826,240,2244,2182,1122,2573,1786,207,3099,3668,2152,707,707,3556,1847,443,2542,93,444,1014,1393,1163,267,1560,3183,3500,59,3550,1480,1799,2826,3020,456,2930,1715,1052,417,3769,1871,3170,1912,2918,2651,175,3739,801,1732,536,928,2088,306,218,2868,973,191,1493,1254,1434,3094,635,2855,2032,2547,3185,2287,1737,1101,3771,1761,3754,1286,1210,2363,930,1625,2319,2212,78,2571,2022,2787,1909,2966,2971,3133,348,482,3126,835,2603,233,1317,721,1543,3131,1837,1136,1089,209,344,131,1480,3461,3094,1825,2593,3322,2231,1476,1920,1658,3326,672,3810,2432,3067,1554,1740,3664,3907,3849,3453,1200,71,2083,2319,618,186,3142,1515,3293,3079,2522,847,2264,2834,1948,3225,464,2465,789,3510,2079,3879,178,3089,2777,2942,3405,3555,1139,2223,1192,1701,2561,3504,1458,396,3632,1804,2638,3743,1816,3816,2300,966,1091,2274,672,3013,789,3149,2147,1595,2975,1288,100,3106,3941,1525,3742,2890,2015,2595,807,2029,1669,3119,508,3279,898,2608,1672,2308,2967,2993,2134,642,2915,574,1542,3462,1953,2825,2991,1184,698,3477,3258,340,2723,2031,961,1324,946,1388,2689,1658,3464,365,1686,3370,3095,2598,2583,2124,1594,126,2510,3004,662,613,1532,2864,3694,3113,441,1878,180,3834,3122,696,1265,2963,249,2290,3051,1798,3635,361,47,2144,2617,3648,823,1717,3420,3598,730,1327,1025,2234,93,3989,3222,3355,89,3854,3344,3938,1181,2904,3416,145,2856,1900,3250,2566,2371,891,3973,2690,994,290,2127,1614,3263,1342,3958,721,925,2759,2835,3651,2481,2853,1618,1471,754,3621,574,836,1182,2207,2590,3077,2875,595,662,1085,3081,621,2458,3050,4031,730,2272,317,3526,84,3517,307,2586,800,3393,3566,1030,1169,2909,1201,959,2925,4014,1595,2075,3468,1299,2535,3225,256,1453,1466,1538,4102,2497,601,2927,4143,1761,2104,1695,2231,1593,4174,2438,508,723,2476,3387,2637,266,447,3358,3573,3090,1799,2966,2234,1169,330,194,2753,2120,2648,342,1140,46,2885,2417,3545,3414,538,2321,2172,629,274,2306,422,664,3609,306,2966,3095,3990,324,4067,2508,94,2509,995,479,4125,4082,3445,1372,3679,27,2750,27,1334,61,3091,470,3950,1252,3639,3821,3862,3323,321,2571,1579,4215,2283,2511,635,2259,2186,1933,2768,2526,4265,159,2105,1481,1782,396,3280,14,3707,1782,830,3390,1948,1228,2581,1518,2320,71,1981,2784,1954,282,1281,2869,296,845,776,3333,2129,519,140,1786,835,3928,1589,2015,2543,3437,537,2128,2751,1450,2852,2848,1095,2116,4236,4035,2926,1678,3019,813,3070,4061,3338,3122,4015,3727,2306,3594,668,765,3860,316,1254,4068,647,105,3191,2911,3538,933,4286,176,3874,327,1056,318,1984,247,1030,1684,687,2814,3069,3920,2059,3272,732,732,1983,2470,2506,1846,626,2589,1239,3715,260,515,4160,4324,4352,1541,3564,1249,1849,4126,2604,2,4148,3311,4220,1983,3082,1373,250,2333,3924,588,4083,2068,1442,6,3055,1660,1413,561,16,3041,433,2902,1423,2221,2896,2111,4065,3278,724,3992,1976,2079,4291,4112,1116,3300,1574,2210,3425,4407,4233,2308,406,1362,3643,626,1877,1651,3192,432,2678,3934,3158,231,3739,2512,1523,2963,1661,1523,2944,3374,3168,3523,2463,1342,877,2003,964,1066,3188,2942,25,1705,809,4434,4372,1250,3866,2717,909,1514,825,3660,3647,1925,976,1918,3090,2054,3999,2670,942,2836,855,3266,1693,2579,2535,1129,3143,1451,3423,3199,776,2941,1149,710,779,4065,1008,1535,1679,3981,3678,3492,3429,1366,3327,4162,2925,2417,3231,2971,875,2892,1989,275,2102,2871,4231,2595,757,4324,4307,1279,3693,3825,4160,800,2120,1651,1369,2172,204,391,2785,4447,1968,924,2515,982,1293,629,1118,3968,1512,4027,2284,641,4419,3479,1897,1876,907,4469,673,3287,2005,508,2568,1021,4039,1146,1078,1064,1921,4216,637,4216,3687,2144,2733,2463,4310,3600,3471,4191,4438,2999,2115,3895,2582,334,2802,2832,2475,3285,3617,1061,3506,2075,3802,2184,3845,2773,1782,769,2732,2977,3717,4352,4409,1974,2669,1164,4381,2232,1014,3262,1462,2895,3317,3833,2143,
    4033,3015,1128,2740,2482,865,8,4186,3685,4546,2961,2880,2805,2882,3962,1194,1951,250,1575,3350,1423,1481,1984,4231,835,3577,3386,124,2991,3101,1437,2273,3004,79,516,690,686,3671,3388,1542,1615,749,3866,3879,1874,1502,3755,54,3997,1266,3888,1672,1991,983,2317,218,4507,2116,1828,2052,3694,1146,1517,3559,546,3804,4421,2990,2982,2297,2446,3902,4053,4243,4106,1446,4278,3185,2591,593,4193,2559,3047,104,2958,2262,2890,3622,4572,4551,1659,3007,2538,1516,1240,3516,4343,357,3026,4244,4011,3559,2761,1628,951,3922,1702,829,1348,2542,647,3582,1357,1464,4608,4500,3466,1327,2111,1850,6,124,2462,2166,2177,3948,3134,3110,1284,4345,3065,4510,1922,4233,4628,1503,2948,4479,428,3803,37,2010,1211,2952,3643,1167,1419,508,1040,549,4583,3415,2876,3815,4732,3467,3769,2745,1903,609,3772,1190,1984,2811,903,4610,4049,4328,735,486,2641,4190,1271,3265,3024,3229,2601,962,3665,3114,2079,1714,2519,3212,919,487,15,1544,3787,2396,415,633,1292,1068,2908,883,4143,2129,1065,4512,40,1064,2454,1155,1227,1313,1872,1777,649,4696,516,4649,2301,3723,3491,2724,4705,1524,2900,3285,4126,2955,1719,3930,2491,4190,4725,591,1909,3133,1439,3671,4714,2758,2781,2706,3868,1655,1291,2484,3243,4229,1388,2684,4358,383,4011,4852,38,2880,1900,4307,2008,2313,3257,1601,203,1944,3692,4383,2065,1359,734,230,1463,3789,1861,3692,954,2286,2122,2132,798,428,3273,1447,1537,3917,803,2695,4439,4397,3959,4468,960,730,2506,3459,1620,2868,3234,3016,3349,2978,1321,1706,4655,580,2702,4531,3416,2224,381,150,4322,1120,2275,2849,3326,4024,166,672,3153,3309,584,3159,1933,3334,247,4879,3916,2201,2656,1965,1018,3646,2961,224,653,2943,3153,4573,2044,4496,2071,3178,2150,1273,288,3143,1010,1121,2924,625,4400,4526,2510,1568,2190,1641,3106,3521,3870,1450,3226,2116,418,664,3909,2386,1370,2329,342,3162,4542,2115,2109,1578,1840,1321,3413,3553,411,1148,565,3011,1384,1615,4416,2716,2286,2951,2526,2821,1323,3438,3944,1011,2184,2581};
    out << (s.waysToBuildRooms(v) == 286231764) << std::endl;
}

int main()
{
    std::ios::sync_with_stdio(false);
    //std::cout << "hello dude";

    std::ifstream fin("input.txt");
    std::ofstream fout("output.txt");

    // solve(std::cin, std::cout);
    // solve(std::cin, fout);
    solve(fin, std::cout);
    // solve(fin, fout);
    

    return 0;
}